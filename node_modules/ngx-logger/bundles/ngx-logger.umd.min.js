!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("vlq"),require("rxjs")):"function"==typeof define&&define.amd?define("ngx-logger",["exports","@angular/common","@angular/core","@angular/common/http","rxjs/operators","vlq","rxjs"],t):t((e=e||self)["ngx-logger"]={},e.ng.common,e.ng.core,e.ng.common.http,e.rxjs.operators,e.vlq,e.rxjs)}(this,function(e,t,r,n,o,i,a){"use strict";function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var u=function(){function e(e){this.httpBackend=e}return e.prototype.logOnServer=function(e,t,r){var i=new n.HttpRequest("POST",e,t,r||{});return this.httpBackend.handle(i).pipe(o.filter(function(e){return e instanceof n.HttpResponse}),o.map(function(e){return e.body}))},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:n.HttpBackend}]},e}(),l={TRACE:0,DEBUG:1,INFO:2,LOG:3,WARN:4,ERROR:5,FATAL:6,OFF:7};l[l.TRACE]="TRACE",l[l.DEBUG]="DEBUG",l[l.INFO]="INFO",l[l.LOG]="LOG",l[l.WARN]="WARN",l[l.ERROR]="ERROR",l[l.FATAL]="FATAL",l[l.OFF]="OFF";var p=function(){},f=function(){function e(e){this.config=e,this._config=e}return e.prototype.updateConfig=function(e){this._config=this._clone(e)},e.prototype.getConfig=function(){return this._clone(this._config)},e.prototype._clone=function(e){var t=new p;return Object.keys(e).forEach(function(r){t[r]=e[r]}),t},e}(),g=function(){function e(){}return e.prepareMetaString=function(e,t,r,n){return e+" "+t+(r?" ["+r+":"+n+"]":"")},e.getColor=function(e){switch(e){case l.TRACE:return"blue";case l.DEBUG:return"teal";case l.INFO:case l.LOG:return"gray";case l.WARN:case l.ERROR:case l.FATAL:return"red";case l.OFF:default:return}},e.getCallerDetails=function(){var e=new Error("");try{var t=e.stack.split("\n")[4].split("/"),r=t[t.length-1].replace(/[)]/g,"").split(":");return{fileName:r[0],lineNumber:r[1]}}catch(n){return{fileName:null,lineNumber:null}}},e.prepareMessage=function(e){try{"string"==typeof e||e instanceof Error||(e=JSON.stringify(e,null,2))}catch(t){e='The provided "message" value could not be parsed with JSON.stringify().'}return e},e.prepareAdditionalParameters=function(e){return null===e||e===undefined?null:e.map(function(e,t){try{return"object"==typeof e&&JSON.stringify(e),e}catch(r){return"The additional["+t+"] value could not be parsed using JSON.stringify()."}})},e}(),h=function(){function e(e,t,r){this.fileName=e,this.lineNumber=t,this.columnNumber=r}return e.prototype.toString=function(){return this.fileName+":"+this.lineNumber+":"+this.columnNumber},e}(),d=function(){function e(e){this.httpBackend=e,this.logPositionRequests=new Map}return e.getStackLine=function(){var e=new Error;try{throw e}catch(t){try{return e.stack.split("\n")[5]}catch(t){return null}}},e.getPosition=function(e){var t=e.lastIndexOf("/"),r=e.indexOf(")");r<0&&(r=undefined);var n=e.substring(t+1,r).split(":");return 3===n.length?new h(n[0],+n[1],+n[2]):new h("unknown",0,0)},e.getTranspileLocation=function(e){var t=e.indexOf("(");t<0&&(t=e.lastIndexOf(" "));var r=e.indexOf(")");return r<0&&(r=undefined),e.substring(t+1,r)},e.getMapFilePath=function(t){var r=e.getTranspileLocation(t),n=r.substring(0,r.lastIndexOf(":"));return n.substring(0,n.lastIndexOf(":"))+".map"},e.getMapping=function(e,t){for(var r=0,n=0,o=0,a=e.mappings.split(";"),s=0;s<a.length;s++)for(var c=0,u=a[s].split(","),l=0;l<u.length;l++){var p=i.decode(u[l]);if(p.length>=4&&(c+=p[0],r+=p[1],n+=p[2],o+=p[3]),s===t.lineNumber){if(c===t.columnNumber)return new h(e.sources[r],n,o);if(l+1===u.length)return new h(e.sources[r],n,0)}}return new h("unknown",0,0)},e.prototype._getSourceMap=function(t,r){var i=new n.HttpRequest("GET",t);if(!this.logPositionRequests.has(t)){var s=this.httpBackend.handle(i).pipe(o.filter(function(e){return e instanceof n.HttpResponse}),o.map(function(e){return e.body}),o.map(function(t){return e.getMapping(t,r)}),o.retry(3),o.catchError(function(){return a.of(r)}),o.shareReplay(1));this.logPositionRequests.set(t,s)}return this.logPositionRequests.get(t)},e.prototype.getCallerDetails=function(t){var r=this,n=e.getStackLine();return n?a.of([e.getPosition(n),e.getMapFilePath(n)]).pipe(o.switchMap(function(e){var n=s(e,2),o=n[0],i=n[1];return t?r._getSourceMap(i,o):a.of(o)})):a.of(new h("",0,0))},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:n.HttpBackend}]},e}(),v=["TRACE","DEBUG","INFO","LOG","WARN","ERROR","FATAL","OFF"],y=function(){function e(e,t,r){this.mapperService=e,this.httpService=t,this._withCredentials=!1,this._isIE=navigator&&navigator.userAgent&&!(-1===navigator.userAgent.indexOf("MSIE")&&!navigator.userAgent.match(/Trident\//)&&!navigator.userAgent.match(/Edge\//)),this.config=new f(r),this._logFunc=this._isIE?this._logIE.bind(this):this._logModern.bind(this)}return e.prototype.trace=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.TRACE,e,t)},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.DEBUG,e,t)},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.INFO,e,t)},e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.LOG,e,t)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.WARN,e,t)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.ERROR,e,t)},e.prototype.fatal=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._log(l.FATAL,e,t)},e.prototype.setCustomHttpHeaders=function(e){this._customHttpHeaders=e},e.prototype.setCustomParams=function(e){this._customParams=e},e.prototype.setWithCredentialsOptionValue=function(e){this._withCredentials=e},e.prototype.registerMonitor=function(e){this._loggerMonitor=e},e.prototype.updateConfig=function(e){this.config.updateConfig(e)},e.prototype.getConfigSnapshot=function(){return this.config.getConfig()},e.prototype._logIE=function(e,t,r,n){switch(n=n||[],e){case l.WARN:console.warn.apply(console,c([t+" ",r],n));break;case l.ERROR:case l.FATAL:console.error.apply(console,c([t+" ",r],n));break;case l.INFO:console.info.apply(console,c([t+" ",r],n));break;default:console.log.apply(console,c([t+" ",r],n))}},e.prototype._logModern=function(e,t,r,n){var o=g.getColor(e);switch(n=n||[],e){case l.WARN:console.warn.apply(console,c(["%c"+t,"color:"+o,r],n));break;case l.ERROR:case l.FATAL:console.error.apply(console,c(["%c"+t,"color:"+o,r],n));break;case l.INFO:console.info.apply(console,c(["%c"+t,"color:"+o,r],n));break;default:console.log.apply(console,c(["%c"+t,"color:"+o,r],n))}},e.prototype._log=function(e,t,r,o){var i=this;void 0===r&&(r=[]),void 0===o&&(o=!0);var a=this.config.getConfig(),s=o&&a.serverLoggingUrl&&e>=a.serverLogLevel,c=e>=a.level;if(t&&(s||c)){var u=v[e];t="function"==typeof t?t():t,t=g.prepareMessage(t);var p=g.prepareAdditionalParameters(r),f=(new Date).toISOString();this.mapperService.getCallerDetails(a.enableSourceMaps).subscribe(function(o){var h={message:t,additional:p,level:e,timestamp:f,fileName:o.fileName,lineNumber:o.lineNumber.toString()};if(i._loggerMonitor&&c&&i._loggerMonitor.onLog(h),s){t=t instanceof Error?t.stack:t,h.message=t;var d=i._customHttpHeaders||new n.HttpHeaders;d.set("Content-Type","application/json");var v={headers:d,params:i._customParams||new n.HttpParams,responseType:a.httpResponseType||"json",withCredentials:i._withCredentials};i.httpService.logOnServer(a.serverLoggingUrl,h,v).subscribe(function(e){},function(e){i._log(l.ERROR,"FAILED TO LOG ON SERVER: "+t,[e],!1)})}if(c&&!a.disableConsoleLogging){var y=g.prepareMetaString(f,u,o.fileName,o.lineNumber.toString());return i._logFunc(e,y,t,r)}})}},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:d},{type:u},{type:p}]},e}(),m=function(){function e(e,t){this.mapperService=e,this.httpService=t}return e.prototype.create=function(e,t,r,n){var o=new y(n||this.mapperService,t||this.httpService,e);return r&&o.registerMonitor(r),o},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:d},{type:u}]},e}(),R=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:p,useValue:t||{}},y,u,m,d]}},e.forChild=function(){return{ngModule:e,providers:[y,u,m,d]}},e.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule],providers:[y,u,m,d]}]}],e}(),O=function(){},N=function(){};e.CustomNGXLoggerService=m,e.Levels=v,e.LoggerConfig=p,e.LoggerModule=R,e.NGXLogInterface=N,e.NGXLogger=y,e.NGXLoggerHttpService=u,e.NGXLoggerMonitor=O,e.NGXLoggerUtils=g,e.NGXMapperService=d,e.NgxLoggerLevel=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-logger.umd.min.js.map